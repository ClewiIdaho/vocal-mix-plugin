<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Mix Master Pro</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

:root {
  --accent: #00d4ff;
  --accent-glow: rgba(0, 212, 255, 0.4);
  --glass-border: rgba(255, 255, 255, 0.08);
  --text: #f0f2f5;
  --text-dim: rgba(255, 255, 255, 0.5);
}

html, body {
  background: transparent !important;
  overflow: hidden !important;
  margin: 0 !important;
  padding: 0 !important;
  width: 100%;
  height: 100%;
}

body {
  font-family: 'Inter', system-ui, sans-serif;
  display: flex;
  align-items: flex-start;
  justify-content: center;
}

/* MAIN CONTAINER */
.mixer {
  width: calc(100% - 20px);
  max-width: 420px;
  margin: 10px;
  background: linear-gradient(
    165deg,
    rgba(25, 28, 40, 0.97) 0%,
    rgba(15, 17, 25, 0.98) 50%,
    rgba(10, 12, 18, 0.99) 100%
  );
  border-radius: 24px;
  padding: 18px;
  padding-bottom: 20px;
  position: relative;
  overflow: hidden;
  box-shadow: 
    0 25px 60px rgba(0, 0, 0, 0.5),
    0 0 0 1px rgba(255, 255, 255, 0.06),
    inset 0 1px 0 rgba(255, 255, 255, 0.08);
}

/* MARBLE / AURORA RGB EFFECT */
.mixer::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: 
    radial-gradient(ellipse at 20% 30%, rgba(0, 212, 255, 0.07) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 20%, rgba(168, 85, 247, 0.06) 0%, transparent 50%),
    radial-gradient(ellipse at 50% 70%, rgba(34, 197, 94, 0.05) 0%, transparent 50%),
    radial-gradient(ellipse at 75% 80%, rgba(244, 63, 94, 0.04) 0%, transparent 50%),
    radial-gradient(ellipse at 25% 75%, rgba(245, 158, 11, 0.04) 0%, transparent 50%);
  animation: marble 20s ease-in-out infinite alternate;
  pointer-events: none;
  z-index: 0;
}

@keyframes marble {
  0% {
    transform: translate(0%, 0%) rotate(0deg);
    opacity: 0.7;
  }
  33% {
    transform: translate(3%, -3%) rotate(3deg);
    opacity: 0.9;
  }
  66% {
    transform: translate(-3%, 3%) rotate(-3deg);
    opacity: 0.8;
  }
  100% {
    transform: translate(0%, 0%) rotate(0deg);
    opacity: 0.7;
  }
}

/* TOP GLASS SHINE */
.mixer::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 35%;
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.05) 0%,
    rgba(255, 255, 255, 0.02) 50%,
    transparent 100%
  );
  border-radius: 24px 24px 0 0;
  pointer-events: none;
  z-index: 1;
}

/* HEADER */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 14px;
  padding-bottom: 12px;
  border-bottom: 1px solid var(--glass-border);
  position: relative;
  z-index: 3;
}

.logo {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo-icon {
  width: 34px;
  height: 34px;
  background: linear-gradient(135deg, var(--accent), rgba(0, 150, 200, 0.8));
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  box-shadow: 0 4px 15px var(--accent-glow);
}

.logo-text {
  font-weight: 700;
  font-size: 15px;
  color: var(--text);
}

.logo-badge {
  font-size: 7px;
  background: linear-gradient(135deg, var(--accent), #0090b0);
  color: #000;
  padding: 2px 5px;
  border-radius: 3px;
  font-weight: 700;
  margin-left: 5px;
}

.header-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.led-wrap {
  display: flex;
  align-items: center;
  gap: 4px;
}

.led-label {
  font-size: 7px;
  color: var(--text-dim);
  text-transform: uppercase;
}

.led {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.15);
  transition: all 0.3s ease;
}

.led.active {
  background: var(--accent);
  box-shadow: 0 0 8px var(--accent), 0 0 20px var(--accent-glow);
  animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.7; }
}

.themes {
  display: flex;
  gap: 4px;
}

.theme-dot {
  width: 14px;
  height: 14px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid transparent;
  transition: all 0.2s ease;
  box-shadow: 0 2px 6px rgba(0,0,0,0.3);
}

.theme-dot:hover { transform: scale(1.15); }
.theme-dot.active { border-color: rgba(255,255,255,0.8); }

/* DISPLAY */
.display {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid var(--glass-border);
  border-radius: 14px;
  padding: 12px;
  margin-bottom: 12px;
  position: relative;
  z-index: 3;
}

.static-waveform {
  height: 45px;
  margin-bottom: 8px;
  border-radius: 8px;
  background: rgba(0, 0, 0, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.static-waveform canvas {
  width: 100%;
  height: 100%;
  display: none;
}

.waveform-placeholder {
  color: var(--text-dim);
  font-size: 9px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.visualizer-wrap {
  height: 35px;
  margin-bottom: 8px;
  border-radius: 8px;
  background: rgba(0, 0, 0, 0.3);
  overflow: hidden;
  position: relative;
}

.waveform {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 2px;
  padding: 0 6px;
}

.wave-bar {
  width: 2px;
  min-height: 3px;
  background: var(--accent);
  border-radius: 1px;
  opacity: 0.6;
  transition: height 0.05s ease;
}

.wave-bar.active {
  opacity: 1;
  box-shadow: 0 0 4px var(--accent-glow);
}

.meters {
  position: absolute;
  right: 5px;
  top: 5px;
  bottom: 5px;
  display: flex;
  gap: 2px;
}

.meter {
  width: 4px;
  background: rgba(0,0,0,0.4);
  border-radius: 2px;
  display: flex;
  flex-direction: column-reverse;
}

.meter-fill {
  background: linear-gradient(to top, #22c55e, #eab308, #ef4444);
  border-radius: 2px;
  transition: height 0.1s ease;
}

.track-info {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 8px;
}

.track-icon {
  width: 38px;
  height: 38px;
  background: rgba(255,255,255,0.05);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  border: 1px solid var(--glass-border);
}

.track-details { flex: 1; min-width: 0; }

.track-name {
  font-size: 12px;
  font-weight: 600;
  color: var(--text);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.track-meta { display: flex; gap: 6px; flex-wrap: wrap; }

.meta-tag {
  font-size: 8px;
  color: var(--accent);
  background: rgba(0,212,255,0.1);
  padding: 2px 5px;
  border-radius: 3px;
  font-weight: 600;
}

.track-status {
  font-size: 8px;
  color: var(--text-dim);
  text-transform: uppercase;
}

.file-label {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 10px;
  background: rgba(255,255,255,0.03);
  border-radius: 10px;
  cursor: pointer;
  font-size: 11px;
  font-weight: 500;
  color: var(--text);
  border: 1px dashed rgba(255,255,255,0.12);
  transition: all 0.2s ease;
}

.file-label:hover {
  border-color: var(--accent);
  background: rgba(0,212,255,0.06);
  color: var(--accent);
}

.file-input { display: none; }

/* TOOLS */
.tools-row {
  display: flex;
  gap: 5px;
  margin-bottom: 12px;
  position: relative;
  z-index: 3;
}

.tool-btn {
  flex: 1;
  padding: 7px 5px;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--glass-border);
  border-radius: 8px;
  color: var(--text-dim);
  font-size: 7px;
  font-weight: 600;
  text-transform: uppercase;
  cursor: pointer;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 2px;
  transition: all 0.2s ease;
}

.tool-btn span { font-size: 12px; }

.tool-btn:hover {
  background: rgba(0,212,255,0.08);
  border-color: var(--accent);
  color: var(--accent);
}

.bpm-display {
  font-size: 12px;
  font-weight: 700;
  color: var(--accent);
}

/* SECTIONS */
.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
  position: relative;
  z-index: 3;
}

.section-title {
  font-size: 8px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
  letter-spacing: 0.8px;
}

/* KNOBS */
.knobs-section {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 5px;
  margin-bottom: 10px;
  position: relative;
  z-index: 3;
}

.knob-group { text-align: center; }

.knob-container {
  width: 48px;
  height: 48px;
  margin: 0 auto 3px;
  position: relative;
}

.knob {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  background: linear-gradient(145deg, rgba(60,65,85,0.9), rgba(25,28,40,0.95));
  box-shadow: 
    0 5px 15px rgba(0,0,0,0.4),
    inset 0 2px 0 rgba(255,255,255,0.1),
    inset 0 -2px 4px rgba(0,0,0,0.3);
  position: relative;
  cursor: grab;
  border: 1px solid rgba(255,255,255,0.06);
  transition: box-shadow 0.2s ease;
}

.knob:hover {
  box-shadow: 
    0 5px 20px rgba(0,0,0,0.5),
    0 0 0 2px var(--accent-glow),
    inset 0 2px 0 rgba(255,255,255,0.12);
}

.knob::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 50%;
  height: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(145deg, rgba(45,48,60,0.9), rgba(25,28,38,0.95));
  border-radius: 50%;
}

.knob-indicator {
  position: absolute;
  top: 4px;
  left: 50%;
  width: 3px;
  height: 8px;
  background: var(--accent);
  border-radius: 2px;
  transform-origin: center 20px;
  transform: translateX(-50%);
  box-shadow: 0 0 6px var(--accent-glow);
}

.knob-ring {
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  border-radius: 50%;
  border: 1px solid transparent;
  border-top-color: var(--accent);
  opacity: 0.15;
  transform: rotate(-135deg);
}

.knob:hover .knob-ring { opacity: 0.4; }

.knob-label {
  font-size: 7px;
  font-weight: 600;
  color: var(--text-dim);
  text-transform: uppercase;
}

.knob-value {
  font-size: 8px;
  color: var(--accent);
  font-weight: 600;
}

/* ADVANCED */
.toggle-advanced {
  font-size: 7px;
  color: var(--accent);
  background: none;
  border: none;
  cursor: pointer;
  padding: 2px 5px;
  border-radius: 3px;
}

.toggle-advanced:hover { background: rgba(0,212,255,0.1); }

.advanced-knobs {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 5px;
  max-height: 0;
  overflow: hidden;
  opacity: 0;
  transition: all 0.3s ease;
}

.advanced-knobs.show {
  max-height: 90px;
  opacity: 1;
  margin-bottom: 10px;
}

/* PRESETS */
.presets {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 4px;
  margin-bottom: 10px;
  position: relative;
  z-index: 3;
}

.preset-btn {
  padding: 7px 4px;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--glass-border);
  border-radius: 6px;
  color: var(--text-dim);
  font-size: 7px;
  font-weight: 600;
  text-transform: uppercase;
  cursor: pointer;
  transition: all 0.2s ease;
}

.preset-btn:hover {
  background: rgba(0,212,255,0.08);
  border-color: var(--accent);
  color: var(--accent);
}

.preset-btn.active {
  background: linear-gradient(135deg, var(--accent), #0090b0);
  color: #000;
  border-color: var(--accent);
}

/* MASTER */
.master-section {
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--glass-border);
  border-radius: 10px;
  padding: 10px;
  margin-bottom: 10px;
  position: relative;
  z-index: 3;
}

.master-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.master-label {
  font-size: 9px;
  font-weight: 600;
  color: var(--text);
  text-transform: uppercase;
  display: flex;
  align-items: center;
  gap: 5px;
}

.master-icon { font-size: 12px; }

.master-value {
  font-size: 13px;
  color: var(--accent);
  font-weight: 700;
}

.slider-track {
  position: relative;
  height: 6px;
  background: rgba(255,255,255,0.06);
  border-radius: 3px;
}

.slider-fill {
  position: absolute;
  left: 0;
  top: 0;
  height: 100%;
  background: linear-gradient(90deg, var(--accent), rgba(0,180,220,0.7));
  border-radius: 3px;
  box-shadow: 0 0 10px var(--accent-glow);
  transition: width 0.1s ease;
}

.slider {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  -webkit-appearance: none;
  background: transparent;
  cursor: pointer;
  margin: 0;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  width: 16px;
  height: 16px;
  background: linear-gradient(145deg, #fff, #ddd);
  border-radius: 50%;
  box-shadow: 0 2px 6px rgba(0,0,0,0.4);
  margin-top: -5px;
}

.slider::-moz-range-thumb {
  width: 16px;
  height: 16px;
  background: linear-gradient(145deg, #fff, #ddd);
  border-radius: 50%;
  border: none;
}

/* EXPORT */
.export-section {
  margin-bottom: 10px;
  position: relative;
  z-index: 3;
}

.export-options {
  display: flex;
  gap: 4px;
}

.export-btn {
  flex: 1;
  padding: 6px 4px;
  background: rgba(255,255,255,0.03);
  border: 1px solid var(--glass-border);
  border-radius: 6px;
  color: var(--text-dim);
  font-size: 7px;
  font-weight: 600;
  text-transform: uppercase;
  cursor: pointer;
  text-align: center;
  transition: all 0.2s ease;
}

.export-btn:hover {
  border-color: var(--accent);
  color: var(--accent);
}

.export-btn.active {
  background: rgba(0,212,255,0.12);
  border-color: var(--accent);
  color: var(--accent);
}

.export-btn small {
  display: block;
  font-size: 6px;
  opacity: 0.6;
  margin-top: 1px;
}

/* BUTTONS */
.buttons {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 6px;
  margin-bottom: 10px;
  position: relative;
  z-index: 3;
}

.btn {
  padding: 12px 10px;
  border: none;
  border-radius: 10px;
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 5px;
  position: relative;
  overflow: hidden;
  transition: all 0.2s ease;
}

.btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 50%;
  background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 100%);
  pointer-events: none;
}

.btn-play {
  background: linear-gradient(135deg, var(--accent), rgba(0,160,200,1));
  color: #000;
  box-shadow: 0 4px 18px var(--accent-glow);
}

.btn-play:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 25px var(--accent-glow);
}

.btn-download {
  background: rgba(255,255,255,0.05);
  color: var(--text);
  border: 1px solid var(--glass-border);
}

.btn-download:hover {
  background: rgba(255,255,255,0.1);
  border-color: var(--accent);
  transform: translateY(-2px);
}

.btn:disabled {
  opacity: 0.4;
  cursor: not-allowed;
  transform: none !important;
}

/* PROCESSING BAR */
.processing-bar {
  height: 3px;
  background: rgba(255,255,255,0.06);
  border-radius: 2px;
  margin-bottom: 10px;
  overflow: hidden;
  opacity: 0;
  transition: opacity 0.3s ease;
  position: relative;
  z-index: 3;
}

.processing-bar.active { opacity: 1; }

.processing-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), rgba(0,212,255,0.4), var(--accent));
  background-size: 200% 100%;
  animation: loading 1.5s infinite;
  border-radius: 2px;
}

@keyframes loading {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* AUDIO PLAYER */
.audio-wrap {
  background: rgba(255,255,255,0.02);
  border: 1px solid var(--glass-border);
  border-radius: 10px;
  padding: 8px;
  margin-bottom: 10px;
  position: relative;
  z-index: 3;
}

audio {
  width: 100%;
  height: 32px;
  border-radius: 6px;
  outline: none;
}

/* FOOTER */
.footer {
  text-align: center;
  padding-top: 8px;
  border-top: 1px solid var(--glass-border);
  position: relative;
  z-index: 3;
}

.footer-text {
  font-size: 8px;
  color: var(--text-dim);
  letter-spacing: 0.2px;
}

/* RESPONSIVE */
@media (max-width: 480px) {
  .mixer {
    margin: 6px;
    padding: 14px;
    padding-bottom: 16px;
    border-radius: 20px;
  }
  
  .knob-container {
    width: 44px;
    height: 44px;
  }
  
  .knob-indicator {
    height: 7px;
    transform-origin: center 18px;
  }
}
</style>
</head>

<body>

<div class="mixer">
  <div class="header">
    <div class="logo">
      <div class="logo-icon">üéõÔ∏è</div>
      <div>
        <span class="logo-text">Mix Master</span>
        <span class="logo-badge">PRO</span>
      </div>
    </div>
    <div class="header-right">
      <div class="led-wrap">
        <span class="led-label">Live</span>
        <div class="led" id="led"></div>
      </div>
      <div class="themes">
        <div class="theme-dot active" style="background:#00d4ff" onclick="setTheme('#00d4ff')"></div>
        <div class="theme-dot" style="background:#a855f7" onclick="setTheme('#a855f7')"></div>
        <div class="theme-dot" style="background:#22c55e" onclick="setTheme('#22c55e')"></div>
        <div class="theme-dot" style="background:#f43f5e" onclick="setTheme('#f43f5e')"></div>
        <div class="theme-dot" style="background:#f59e0b" onclick="setTheme('#f59e0b')"></div>
      </div>
    </div>
  </div>

  <div class="display">
    <div class="static-waveform" id="staticWaveform">
      <span class="waveform-placeholder">Waveform Preview</span>
      <canvas id="waveformCanvas"></canvas>
    </div>
    <div class="visualizer-wrap">
      <div class="waveform" id="waveform"></div>
      <div class="meters">
        <div class="meter"><div class="meter-fill" id="meterL" style="height:0%"></div></div>
        <div class="meter"><div class="meter-fill" id="meterR" style="height:0%"></div></div>
      </div>
    </div>
    <div class="track-info">
      <div class="track-icon" id="trackIcon">üéµ</div>
      <div class="track-details">
        <div class="track-name" id="trackName">No Track Loaded</div>
        <div class="track-meta" id="trackMeta">
          <span class="track-status" id="trackStatus">Upload a song to begin</span>
        </div>
      </div>
    </div>
    <label class="file-label" for="fileInput">
      <span>üìÅ</span>
      <span>Choose Audio File</span>
    </label>
    <input type="file" id="fileInput" class="file-input" accept="audio/*">
  </div>

  <div class="tools-row">
    <button class="tool-btn" onclick="tapBPM()"><span>ü•Å</span><div class="bpm-display" id="bpmDisplay">---</div><div>Tap BPM</div></button>
    <button class="tool-btn" onclick="toggleMono()"><span>üîä</span><div id="monoDisplay">Stereo</div></button>
    <button class="tool-btn" onclick="resetAll()"><span>‚Ü∫</span><div>Reset</div></button>
    <button class="tool-btn" onclick="randomize()"><span>üé≤</span><div>Random</div></button>
  </div>

  <div class="section-header"><span class="section-title">Mix Controls</span></div>
  <div class="knobs-section">
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobBass"><div class="knob-ring"></div><div class="knob-indicator" id="indBass"></div></div></div><div class="knob-label">Bass</div><div class="knob-value" id="valBass">50%</div></div>
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobMid"><div class="knob-ring"></div><div class="knob-indicator" id="indMid"></div></div></div><div class="knob-label">Mid</div><div class="knob-value" id="valMid">50%</div></div>
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobClarity"><div class="knob-ring"></div><div class="knob-indicator" id="indClarity"></div></div></div><div class="knob-label">Clarity</div><div class="knob-value" id="valClarity">50%</div></div>
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobPunch"><div class="knob-ring"></div><div class="knob-indicator" id="indPunch"></div></div></div><div class="knob-label">Punch</div><div class="knob-value" id="valPunch">50%</div></div>
  </div>

  <div class="section-header"><span class="section-title">Advanced</span><button class="toggle-advanced" onclick="toggleAdvanced()">Show More</button></div>
  <div class="advanced-knobs" id="advancedKnobs">
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobReverb"><div class="knob-ring"></div><div class="knob-indicator" id="indReverb"></div></div></div><div class="knob-label">Reverb</div><div class="knob-value" id="valReverb">20%</div></div>
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobWidth"><div class="knob-ring"></div><div class="knob-indicator" id="indWidth"></div></div></div><div class="knob-label">Width</div><div class="knob-value" id="valWidth">50%</div></div>
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobDeEss"><div class="knob-ring"></div><div class="knob-indicator" id="indDeEss"></div></div></div><div class="knob-label">De-Ess</div><div class="knob-value" id="valDeEss">30%</div></div>
    <div class="knob-group"><div class="knob-container"><div class="knob" id="knobGate"><div class="knob-ring"></div><div class="knob-indicator" id="indGate"></div></div></div><div class="knob-label">Gate</div><div class="knob-value" id="valGate">0%</div></div>
  </div>

  <div class="presets">
    <button class="preset-btn" onclick="applyPreset('clean')">Clean</button>
    <button class="preset-btn" onclick="applyPreset('warm')">Warm</button>
    <button class="preset-btn" onclick="applyPreset('bright')">Bright</button>
    <button class="preset-btn" onclick="applyPreset('punch')">Punchy</button>
    <button class="preset-btn" onclick="applyPreset('hiphop')">Hip-Hop</button>
    <button class="preset-btn" onclick="applyPreset('radio')">Radio Ready</button>
  </div>

  <div class="master-section">
    <div class="master-header">
      <span class="master-label"><span class="master-icon">üéöÔ∏è</span> Master Output</span>
      <span class="master-value" id="masterVal">50%</span>
    </div>
    <div class="slider-track">
      <div class="slider-fill" id="sliderFill" style="width: 50%"></div>
      <input type="range" class="slider" id="masterSlider" min="0" max="100" value="50">
    </div>
  </div>

  <div class="export-section">
    <div class="section-header"><span class="section-title">Export Quality</span></div>
    <div class="export-options">
      <button class="export-btn" onclick="setQuality('standard')">Standard<small>44.1kHz</small></button>
      <button class="export-btn active" onclick="setQuality('high')">High<small>48kHz</small></button>
      <button class="export-btn" onclick="setQuality('studio')">Studio<small>24-bit</small></button>
    </div>
  </div>

  <div class="buttons">
    <button class="btn btn-play" id="btnPlay" onclick="processAndPlay()" disabled>‚ñ∂ Play Mix</button>
    <button class="btn btn-download" id="btnDownload" onclick="downloadMix()" disabled>‚¨á Download</button>
  </div>

  <div class="processing-bar" id="processingBar"><div class="processing-fill"></div></div>

  <div class="audio-wrap">
    <audio id="audioPlayer" controls></audio>
  </div>

  <div class="footer">
    <div class="footer-text">Drag knobs ‚Ä¢ Tap BPM ‚Ä¢ Click presets ‚Ä¢ Pro mixing in your browser</div>
  </div>
</div>

<script>
let audioFile=null,audioContext=null,analyser=null,processedBuffer=null,isPlaying=false,animationId=null,isMono=false,exportQuality='high';
const knobs={bass:50,mid:50,clarity:50,punch:50,reverb:20,width:50,deess:30,gate:0,master:50};
let tapTimes=[];
const led=document.getElementById('led'),audioPlayer=document.getElementById('audioPlayer'),btnPlay=document.getElementById('btnPlay'),btnDownload=document.getElementById('btnDownload'),waveformEl=document.getElementById('waveform'),sliderFill=document.getElementById('sliderFill'),processingBar=document.getElementById('processingBar'),waveformCanvas=document.getElementById('waveformCanvas'),canvasCtx=waveformCanvas.getContext('2d');
const numBars=40;for(let i=0;i<numBars;i++){const bar=document.createElement('div');bar.className='wave-bar';bar.style.height='3px';waveformEl.appendChild(bar)}const waveBars=waveformEl.querySelectorAll('.wave-bar');
function setTheme(color){document.documentElement.style.setProperty('--accent',color);document.documentElement.style.setProperty('--accent-glow',color+'60');document.querySelectorAll('.theme-dot').forEach(dot=>{dot.classList.remove('active');if(dot.style.background===color)dot.classList.add('active')})}
function setupKnob(knobId,indicatorId,valueId,knobKey){const knob=document.getElementById(knobId),indicator=document.getElementById(indicatorId),valueEl=document.getElementById(valueId);if(!knob)return;let isDragging=false,startY=0,startValue=0;const updateKnob=(val)=>{knobs[knobKey]=Math.max(0,Math.min(100,val));const rotation=-135+(knobs[knobKey]/100)*270;indicator.style.transform=`translateX(-50%) rotate(${rotation}deg)`;valueEl.textContent=Math.round(knobs[knobKey])+'%'};const onStart=(y)=>{isDragging=true;startY=y;startValue=knobs[knobKey];knob.style.cursor='grabbing'};const onMove=(y)=>{if(!isDragging)return;const delta=(startY-y)*0.6;updateKnob(startValue+delta)};const onEnd=()=>{isDragging=false;knob.style.cursor='grab'};knob.addEventListener('mousedown',(e)=>{e.preventDefault();onStart(e.clientY)});knob.addEventListener('touchstart',(e)=>{onStart(e.touches[0].clientY)},{passive:true});document.addEventListener('mousemove',(e)=>onMove(e.clientY));document.addEventListener('touchmove',(e)=>onMove(e.touches[0].clientY),{passive:true});document.addEventListener('mouseup',onEnd);document.addEventListener('touchend',onEnd);updateKnob(knobs[knobKey])}
setupKnob('knobBass','indBass','valBass','bass');setupKnob('knobMid','indMid','valMid','mid');setupKnob('knobClarity','indClarity','valClarity','clarity');setupKnob('knobPunch','indPunch','valPunch','punch');setupKnob('knobReverb','indReverb','valReverb','reverb');setupKnob('knobWidth','indWidth','valWidth','width');setupKnob('knobDeEss','indDeEss','valDeEss','deess');setupKnob('knobGate','indGate','valGate','gate');
const masterSlider=document.getElementById('masterSlider'),masterVal=document.getElementById('masterVal');masterSlider.addEventListener('input',()=>{knobs.master=parseInt(masterSlider.value);masterVal.textContent=knobs.master+'%';sliderFill.style.width=knobs.master+'%'});
function toggleAdvanced(){const adv=document.getElementById('advancedKnobs'),btn=document.querySelector('.toggle-advanced');adv.classList.toggle('show');btn.textContent=adv.classList.contains('show')?'Hide':'Show More'}
const presets={clean:{bass:45,mid:50,clarity:55,punch:35,reverb:15,width:50,deess:40,gate:0,master:50},warm:{bass:65,mid:55,clarity:40,punch:45,reverb:25,width:55,deess:20,gate:0,master:55},bright:{bass:40,mid:50,clarity:75,punch:45,reverb:20,width:60,deess:50,gate:0,master:50},punch:{bass:60,mid:50,clarity:55,punch:80,reverb:10,width:45,deess:30,gate:10,master:60},hiphop:{bass:75,mid:45,clarity:60,punch:75,reverb:15,width:65,deess:35,gate:5,master:65},radio:{bass:50,mid:55,clarity:70,punch:65,reverb:20,width:55,deess:45,gate:5,master:60}};
function applyPreset(name){const p=presets[name];if(!p)return;document.querySelectorAll('.preset-btn').forEach(btn=>btn.classList.remove('active'));event.target.classList.add('active');Object.keys(p).forEach(key=>{knobs[key]=p[key];updateKnobDisplay(key,p[key])})}
function updateKnobDisplay(key,val){if(key==='master'){masterSlider.value=val;masterVal.textContent=val+'%';sliderFill.style.width=val+'%';return}const keyMap={bass:'Bass',mid:'Mid',clarity:'Clarity',punch:'Punch',reverb:'Reverb',width:'Width',deess:'DeEss',gate:'Gate'};const indicator=document.getElementById('ind'+keyMap[key]),valueEl=document.getElementById('val'+keyMap[key]);if(indicator&&valueEl){const rotation=-135+(val/100)*270;indicator.style.transform=`translateX(-50%) rotate(${rotation}deg)`;valueEl.textContent=val+'%'}}
function tapBPM(){const now=Date.now();tapTimes.push(now);if(tapTimes.length>1){if(tapTimes.length>8)tapTimes.shift();let totalDiff=0;for(let i=1;i<tapTimes.length;i++)totalDiff+=tapTimes[i]-tapTimes[i-1];const avgDiff=totalDiff/(tapTimes.length-1),bpm=Math.round(60000/avgDiff);document.getElementById('bpmDisplay').textContent=bpm}setTimeout(()=>{if(Date.now()-tapTimes[tapTimes.length-1]>2000)tapTimes=[]},2100)}
function toggleMono(){isMono=!isMono;document.getElementById('monoDisplay').textContent=isMono?'Mono':'Stereo';knobs.width=isMono?0:50;updateKnobDisplay('width',knobs.width)}
function resetAll(){Object.keys(knobs).forEach(key=>{knobs[key]=key==='reverb'?20:key==='deess'?30:key==='gate'?0:50;updateKnobDisplay(key,knobs[key])});document.querySelectorAll('.preset-btn').forEach(btn=>btn.classList.remove('active'))}
function randomize(){Object.keys(knobs).forEach(key=>{knobs[key]=key==='gate'?Math.floor(Math.random()*30):30+Math.floor(Math.random()*40);updateKnobDisplay(key,knobs[key])})}
function setQuality(q){exportQuality=q;document.querySelectorAll('.export-btn').forEach(btn=>btn.classList.remove('active'));event.target.classList.add('active')}
document.getElementById('fileInput').addEventListener('change',async(e)=>{const file=e.target.files[0];if(file){audioFile=file;document.getElementById('trackName').textContent=file.name;document.getElementById('trackStatus').textContent='Ready to mix';document.getElementById('trackIcon').textContent='üéß';btnPlay.disabled=false;btnDownload.disabled=false;drawStaticWaveform(file);const sizeMB=(file.size/1024/1024).toFixed(1);document.getElementById('trackMeta').innerHTML=`<span class="meta-tag">${sizeMB} MB</span><span class="track-status" id="trackStatus">Ready to mix</span>`}});
async function drawStaticWaveform(file){const container=document.getElementById('staticWaveform'),canvas=document.getElementById('waveformCanvas');container.querySelector('.waveform-placeholder').style.display='none';canvas.style.display='block';canvas.width=container.offsetWidth;canvas.height=container.offsetHeight;const ctx=new(window.AudioContext||window.webkitAudioContext)(),arrayBuffer=await file.arrayBuffer(),audioBuffer=await ctx.decodeAudioData(arrayBuffer),data=audioBuffer.getChannelData(0),step=Math.ceil(data.length/canvas.width),amp=canvas.height/2;canvasCtx.fillStyle='rgba(0,0,0,0.3)';canvasCtx.fillRect(0,0,canvas.width,canvas.height);canvasCtx.beginPath();canvasCtx.moveTo(0,amp);for(let i=0;i<canvas.width;i++){let min=1.0,max=-1.0;for(let j=0;j<step;j++){const datum=data[(i*step)+j];if(datum<min)min=datum;if(datum>max)max=datum}canvasCtx.lineTo(i,(1+min)*amp);canvasCtx.lineTo(i,(1+max)*amp)}const accent=getComputedStyle(document.documentElement).getPropertyValue('--accent').trim();canvasCtx.strokeStyle=accent;canvasCtx.lineWidth=1;canvasCtx.stroke();ctx.close()}
function startWaveformAnimation(){if(!analyser)return;const dataArray=new Uint8Array(analyser.frequencyBinCount);const animate=()=>{if(!isPlaying)return;analyser.getByteFrequencyData(dataArray);const step=Math.floor(dataArray.length/numBars);let maxL=0,maxR=0;waveBars.forEach((bar,i)=>{const value=dataArray[i*step]||0,height=Math.max(3,(value/255)*30);bar.style.height=height+'px';bar.classList.toggle('active',value>100);if(i<numBars/2&&value>maxL)maxL=value;if(i>=numBars/2&&value>maxR)maxR=value});document.getElementById('meterL').style.height=(maxL/255)*100+'%';document.getElementById('meterR').style.height=(maxR/255)*100+'%';animationId=requestAnimationFrame(animate)};animate()}
function stopWaveformAnimation(){if(animationId){cancelAnimationFrame(animationId);animationId=null}waveBars.forEach(bar=>{bar.style.height='3px';bar.classList.remove('active')});document.getElementById('meterL').style.height='0%';document.getElementById('meterR').style.height='0%'}
async function processAudio(){if(!audioFile)return null;audioContext=new(window.AudioContext||window.webkitAudioContext)();const arrayBuffer=await audioFile.arrayBuffer(),audioBuffer=await audioContext.decodeAudioData(arrayBuffer),offlineCtx=new OfflineAudioContext(audioBuffer.numberOfChannels,audioBuffer.length,audioBuffer.sampleRate),source=offlineCtx.createBufferSource();source.buffer=audioBuffer;const bassEQ=offlineCtx.createBiquadFilter();bassEQ.type='lowshelf';bassEQ.frequency.value=150;bassEQ.gain.value=(knobs.bass-50)*0.24;const midEQ=offlineCtx.createBiquadFilter();midEQ.type='peaking';midEQ.frequency.value=1000;midEQ.Q.value=0.7;midEQ.gain.value=(knobs.mid-50)*0.18;const clarityEQ=offlineCtx.createBiquadFilter();clarityEQ.type='peaking';clarityEQ.frequency.value=3500;clarityEQ.Q.value=1.0;clarityEQ.gain.value=(knobs.clarity-50)*0.2;const airEQ=offlineCtx.createBiquadFilter();airEQ.type='highshelf';airEQ.frequency.value=10000;airEQ.gain.value=(knobs.clarity-50)*0.1;const deEsser=offlineCtx.createBiquadFilter();deEsser.type='peaking';deEsser.frequency.value=6500;deEsser.Q.value=2;deEsser.gain.value=-(knobs.deess*0.12);const gate=offlineCtx.createBiquadFilter();gate.type='highpass';gate.frequency.value=20+(knobs.gate*2);const compressor=offlineCtx.createDynamicsCompressor();compressor.threshold.value=-18+(50-knobs.punch)*0.3;compressor.ratio.value=1.5+(knobs.punch/100)*5;compressor.attack.value=0.002;compressor.release.value=0.1;compressor.knee.value=5;const widthGain=offlineCtx.createGain();widthGain.gain.value=0.7+(knobs.width/100)*0.6;const reverbDelay=offlineCtx.createDelay();reverbDelay.delayTime.value=0.03;const reverbGain=offlineCtx.createGain();reverbGain.gain.value=knobs.reverb/300;const reverbFilter=offlineCtx.createBiquadFilter();reverbFilter.type='lowpass';reverbFilter.frequency.value=3000;const masterGain=offlineCtx.createGain();masterGain.gain.value=0.6+(knobs.master/100)*0.8;const limiter=offlineCtx.createDynamicsCompressor();limiter.threshold.value=-1.5;limiter.ratio.value=20;limiter.attack.value=0.001;limiter.release.value=0.05;source.connect(gate);gate.connect(bassEQ);bassEQ.connect(midEQ);midEQ.connect(clarityEQ);clarityEQ.connect(airEQ);airEQ.connect(deEsser);deEsser.connect(compressor);compressor.connect(widthGain);widthGain.connect(reverbDelay);reverbDelay.connect(reverbFilter);reverbFilter.connect(reverbGain);reverbGain.connect(masterGain);widthGain.connect(masterGain);masterGain.connect(limiter);limiter.connect(offlineCtx.destination);source.start();return await offlineCtx.startRendering()}
async function processAndPlay(){if(!audioFile)return;document.getElementById('trackStatus').textContent='Processing...';led.classList.add('active');btnPlay.disabled=true;processingBar.classList.add('active');try{processedBuffer=await processAudio();const wav=audioBufferToWav(processedBuffer),blob=new Blob([wav],{type:'audio/wav'}),url=URL.createObjectURL(blob);audioPlayer.src=url;audioContext=new(window.AudioContext||window.webkitAudioContext)();const source=audioContext.createMediaElementSource(audioPlayer);analyser=audioContext.createAnalyser();analyser.fftSize=256;source.connect(analyser);analyser.connect(audioContext.destination);audioPlayer.play();isPlaying=true;startWaveformAnimation();document.getElementById('trackStatus').textContent='Now Playing';document.getElementById('trackIcon').textContent='üîä';btnPlay.disabled=false;processingBar.classList.remove('active')}catch(err){console.error(err);document.getElementById('trackStatus').textContent='Error';led.classList.remove('active');btnPlay.disabled=false;processingBar.classList.remove('active')}}
audioPlayer.addEventListener('play',()=>{isPlaying=true;led.classList.add('active');document.getElementById('trackIcon').textContent='üîä';if(analyser)startWaveformAnimation()});audioPlayer.addEventListener('pause',()=>{isPlaying=false;led.classList.remove('active');document.getElementById('trackIcon').textContent='üéß';stopWaveformAnimation()});audioPlayer.addEventListener('ended',()=>{isPlaying=false;led.classList.remove('active');document.getElementById('trackIcon').textContent='üéß';document.getElementById('trackStatus').textContent='Finished';stopWaveformAnimation()});
async function downloadMix(){if(!audioFile)return;document.getElementById('trackStatus').textContent='Preparing...';btnDownload.disabled=true;processingBar.classList.add('active');try{if(!processedBuffer)processedBuffer=await processAudio();const wav=audioBufferToWav(processedBuffer),blob=new Blob([wav],{type:'audio/wav'}),url=URL.createObjectURL(blob),a=document.createElement('a');a.href=url;a.download='mixed_'+audioFile.name.replace(/\.[^.]+$/,'')+'.wav';a.click();document.getElementById('trackStatus').textContent='Downloaded'}catch(err){document.getElementById('trackStatus').textContent='Failed'}btnDownload.disabled=false;processingBar.classList.remove('active')}
function audioBufferToWav(buffer){const numChannels=buffer.numberOfChannels,sampleRate=buffer.sampleRate,format=1,bitDepth=exportQuality==='studio'?24:16,bytesPerSample=bitDepth/8,blockAlign=numChannels*bytesPerSample,dataLength=buffer.length*blockAlign,bufferLength=44+dataLength,arrayBuffer=new ArrayBuffer(bufferLength),view=new DataView(arrayBuffer),writeString=(offset,string)=>{for(let i=0;i<string.length;i++)view.setUint8(offset+i,string.charCodeAt(i))};writeString(0,'RIFF');view.setUint32(4,bufferLength-8,true);writeString(8,'WAVE');writeString(12,'fmt ');view.setUint32(16,16,true);view.setUint16(20,format,true);view.setUint16(22,numChannels,true);view.setUint32(24,sampleRate,true);view.setUint32(28,sampleRate*blockAlign,true);view.setUint16(32,blockAlign,true);view.setUint16(34,bitDepth,true);writeString(36,'data');view.setUint32(40,dataLength,true);const channels=[];for(let i=0;i<numChannels;i++)channels.push(buffer.getChannelData(i));let offset=44;for(let i=0;i<buffer.length;i++){for(let ch=0;ch<numChannels;ch++){let sample=channels[ch][i];sample=Math.max(-1,Math.min(1,sample));if(bitDepth===16){sample=sample<0?sample*0x8000:sample*0x7FFF;view.setInt16(offset,sample,true);offset+=2}else{sample=sample*0x7FFFFF;view.setInt8(offset,sample&0xFF);view.setInt8(offset+1,(sample>>8)&0xFF);view.setInt8(offset+2,(sample>>16)&0xFF);offset+=3}}}return arrayBuffer}
</script>

</body>
</html>
